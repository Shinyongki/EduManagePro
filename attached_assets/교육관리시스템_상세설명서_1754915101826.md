# 교육관리 시스템 상세 설명서 (모듈화 버전)

![시스템 버전](https://img.shields.io/badge/Version-v2.0.0--modular-blue)
![플랫폼](https://img.shields.io/badge/Platform-Electron-green)
![아키텍처](https://img.shields.io/badge/Architecture-Modular-orange)
![라이선스](https://img.shields.io/badge/License-MIT-yellow)

---

## 📋 목차

1. [시스템 개요](#-시스템-개요)
2. [모듈화 아키텍처](#-모듈화-아키텍처)
3. [시스템 목적 및 배경](#-시스템-목적-및-배경)
4. [핵심 기능](#-핵심-기능)
5. [서비스 모듈별 상세 기능](#-서비스-모듈별-상세-기능)
6. [사용자 워크플로우](#-사용자-워크플로우)
7. [데이터 구조 및 처리 방식](#-데이터-구조-및-처리-방식)
8. [기술적 구현](#-기술적-구현)
9. [사용자 가이드](#-사용자-가이드)
10. [문제해결 가이드](#-문제해결-가이드)
11. [시스템 확장성](#-시스템-확장성)

---

## 🎯 시스템 개요

### 시스템명
**종사자 교육관리 통합 분석 시스템**

### 시스템 유형
- **플랫폼**: Electron 기반 데스크톱 애플리케이션
- **아키텍처**: 모듈화된 Single Page Application (SPA)
- **데이터 저장**: LocalStorage + Excel 파일 연동
- **UI 프레임워크**: Vanilla JavaScript + HTML5 + CSS3
- **모듈 구조**: 5개 독립 서비스 모듈로 분리

### 지원 환경
- **운영체제**: Windows 10/11, macOS 10.14+, Linux (Ubuntu 18.04+)
- **메모리**: 최소 4GB RAM 권장
- **저장공간**: 최소 100MB 여유공간
- **Excel**: Microsoft Excel 2016+ 또는 호환 프로그램

---

## 🏗️ 모듈화 아키텍처

### 아키텍처 개요
기존의 단일 파일 구조를 기능별로 분리하여 **유지보수성**, **확장성**, **재사용성**을 대폭 개선했습니다.

### 모듈 구조

```
renderer/
├── index-modular.html          # 메인 HTML (모듈 통합)
├── ipc-service.js             # IPC 통신 서비스
├── data-processing-service.js  # 데이터 처리 서비스  
├── ui-service.js              # UI 관리 서비스
├── file-operations-service.js  # 파일 처리 서비스
├── excel-export-service.js    # Excel 내보내기 서비스
└── index.html.backup          # 기존 파일 백업
```

### 서비스 모듈별 역할

#### 1. **IPC Service** (`ipc-service.js`)
- **목적**: Electron 프로세스 간 통신 관리
- **주요 기능**:
  - Electron IPC 렌더러 초기화
  - 파일 데이터 수신 이벤트 처리
  - 교육/종사자 데이터 자동 매핑
  - 에러 처리 및 로깅
- **API**:
  ```javascript
  window.ipcService.initialize()                    // IPC 초기화
  window.ipcService.openBasicEducationFile()       // 기본교육 파일 열기
  window.ipcService.openAdvancedEducationFile()    // 심화교육 파일 열기
  window.ipcService.openEmployeeStatusFile()       // 종사자현황 파일 열기
  window.ipcService.openInstitutionStatusFile()    // 기관현황 파일 열기
  ```

#### 2. **Data Processing Service** (`data-processing-service.js`)
- **목적**: 교육/종사자 데이터 가공 및 분석
- **주요 기능**:
  - 교육 수료 데이터 파싱 및 매핑
  - 종사자 현황 통계 계산
  - 근속기간, 채용률, 이수율 자동 계산
  - 데이터 배치 처리로 성능 최적화
- **API**:
  ```javascript
  window.dataProcessingService.saveBasicData(data)        // 기본교육 데이터 저장
  window.dataProcessingService.saveAdvancedData(data)     // 심화교육 데이터 저장
  window.dataProcessingService.parseEducationData(data)   // 교육 데이터 파싱
  window.dataProcessingService.calculateAdvancedFillRate()// 충원률 계산
  ```

#### 3. **UI Service** (`ui-service.js`)
- **목적**: 탭 전환 및 DOM 조작 관리
- **주요 기능**:
  - 메인 탭 및 서브 탭 전환 관리
  - 동적 테이블 생성 및 업데이트
  - 로딩/에러 메시지 표시
  - 진행률 표시기 관리
- **API**:
  ```javascript
  window.uiService.openTab(event, tabName)           // 메인 탭 전환
  window.uiService.openSubTab(event, tabName, parent)// 서브 탭 전환
  window.uiService.createTable(headers, data)        // 동적 테이블 생성
  window.uiService.showLoadingMessage(elementId)     // 로딩 메시지 표시
  ```

#### 4. **File Operations Service** (`file-operations-service.js`)
- **목적**: 파일 업로드/다운로드 처리
- **주요 기능**:
  - 다양한 파일 형식 지원 (xlsx, csv, txt)
  - 파일 유효성 검증
  - 데이터 내보내기 (CSV, TSV, TXT)
  - 파일 크기 계산 및 포맷팅
- **API**:
  ```javascript
  window.fileOperationsService.loadBasicEducationFile()   // 기본교육 파일 로드
  window.fileOperationsService.exportDataToFormat()       // 데이터 내보내기
  window.fileOperationsService.validateFileFormat()       // 파일 형식 검증
  window.fileOperationsService.generateFileName()         // 파일명 생성
  ```

#### 5. **Excel Export Service** (`excel-export-service.js`)
- **목적**: Excel 파일 생성 및 내보내기
- **주요 기능**:
  - SheetJS 라이브러리 동적 로딩
  - 다중 시트 Excel 파일 생성
  - 테이블 데이터 → Excel 변환
  - 스타일링 및 포맷팅 적용
- **API**:
  ```javascript
  window.excelExportService.exportToExcel(data)          // Excel 내보내기
  window.excelExportService.exportMultipleSheets(data)   // 다중 시트 내보내기
  window.excelExportService.exportIntegratedResults()    // 통합 결과 내보내기
  window.excelExportService.exportDashboardData()        // 대시보드 내보내기
  ```

### 모듈화의 이점

#### 1. **유지보수성 향상**
- 각 기능이 독립적인 파일로 분리
- 특정 기능 수정 시 해당 모듈만 수정
- 코드 충돌 최소화

#### 2. **재사용성 증대**
- 각 서비스를 다른 프로젝트에서 재활용 가능
- 독립적인 API 제공으로 모듈 간 결합도 감소

#### 3. **확장성 개선**
- 새로운 기능 추가 시 새 모듈만 생성
- 기존 코드 수정 없이 기능 확장 가능

#### 4. **테스트 용이성**
- 각 모듈을 독립적으로 테스트 가능
- 단위 테스트 작성 용이

#### 5. **개발 효율성**
- 여러 개발자가 동시에 다른 모듈 작업 가능
- 코드 리뷰 및 디버깅 효율성 향상

### 모듈 간 통신

```javascript
// 중앙 집중식 이벤트 시스템
class EventBus {
    constructor() {
        this.events = {};
    }
    
    emit(eventName, data) {
        if (this.events[eventName]) {
            this.events[eventName].forEach(callback => callback(data));
        }
    }
    
    on(eventName, callback) {
        if (!this.events[eventName]) {
            this.events[eventName] = [];
        }
        this.events[eventName].push(callback);
    }
}

window.eventBus = new EventBus();

// 모듈 간 데이터 전달 예시
window.dataProcessingService.processData = (data) => {
    const result = process(data);
    window.eventBus.emit('dataProcessed', result);
};

window.uiService.initialize = () => {
    window.eventBus.on('dataProcessed', (result) => {
        updateUI(result);
    });
};
```

---

## 🚀 시스템 목적 및 배경

### 주요 목적

#### 1. **교육 데이터 통합 관리**
- 기본교육과 심화교육 수료 데이터의 체계적 관리
- 다양한 교육과정별 수료 현황 추적
- 교육 이수율 및 완수율 통계 산출

#### 2. **종사자 현황 종합 분석**
- 전담사회복지사, 생활지원사 등 직무별 현황 파악
- 기관별 채용 현황 및 충원률 분석
- 근속기간, 재직 상태 등 인사 정보 통계

#### 3. **기관 운영 현황 모니터링**
- 기관별 배정 인원 vs 실제 채용 인원 비교
- 예산 배정 대비 충원률 분석
- 지역별, 기관 유형별 운영 현황 파악

#### 4. **데이터 연동 및 매칭**
- 종사자 신상정보와 교육 수료 데이터 자동 매칭
- ID 기반 정확한 데이터 연결
- 중복 데이터 제거 및 정합성 검증

#### 5. **통계 보고서 자동 생성**
- Excel 기반 다중 시트 보고서 생성
- 시각적 통계 차트 및 색상 코딩
- 관리자용 종합 대시보드 제공

### 업무 배경

#### 기존 문제점
- **분산된 데이터 관리**: 교육 데이터와 종사자 데이터가 별도 관리
- **수작업 통계 산출**: Excel 수식 및 매크로에 의존한 비효율적 작업
- **데이터 정합성 문제**: 수동 매칭으로 인한 오류 발생 가능성
- **실시간 모니터링 부재**: 현황 파악을 위한 즉시성 부족

#### 해결 방안
- **통합 플랫폼 구축**: 모든 데이터를 하나의 시스템에서 관리
- **자동화 처리**: 알고리즘 기반 자동 계산 및 통계 생성
- **실시간 대시보드**: 즉시적인 현황 파악 및 의사결정 지원
- **표준화된 워크플로우**: 체계적인 3단계 업무 프로세스 정립

---

## ⭐ 핵심 기능

### 1. **직관적 3단계 워크플로우**
```
📚 교육관리 → 👥 종사자관리 → 🔗 연동분석
```

### 2. **다중 파일 형식 지원**
- Excel (.xlsx, .xls)
- CSV (.csv) 
- 텍스트 복사/붙여넣기

### 3. **실시간 데이터 검증**
- 날짜 형식 자동 검증
- 중복 데이터 감지 및 제거
- 누락 데이터 식별 및 알림

### 4. **고급 통계 분석**
- 채용률, 충원률, 이수율 자동 계산
- 색상 코딩을 통한 성과 지표 시각화
- 근속기간, 경력 분석

### 5. **종합 보고서 생성**
- 3개 시트 통합 Excel 파일 자동 생성
- 교육통합결과, 종사자현황통계, 종사자세부현황
- 인쇄 친화적 레이아웃

---

## 🔧 서비스 모듈별 상세 기능

### 🔌 IPC Service 모듈 (`ipc-service.js`)

#### 클래스 구조
```javascript
class IpcService {
    constructor() {
        this.ipcRenderer = null;
        this.ipcListenersInitialized = false;
    }
    
    initialize()           // IPC 초기화
    setupListeners()       // 이벤트 리스너 설정
    sendFileRequest()      // 파일 요청 전송
    handleFileData()       // 파일 데이터 처리
}
```

#### 주요 메서드

##### `initialize()`
- Electron IPC 렌더러 초기화
- `window.require` 존재 여부 확인
- 오류 처리 및 로깅

##### `setupListeners()`
- 파일 데이터 수신 이벤트 등록
- 파일 타입별 자동 분기 처리
- 에러 이벤트 핸들링

##### `handleBasicEducationData(data)`
- 기본교육 데이터 텍스트 영역에 자동 입력
- 전역 데이터 저장 함수 호출
- UI 업데이트 로깅

### 📊 Data Processing Service 모듈 (`data-processing-service.js`)

#### 클래스 구조
```javascript
class DataProcessingService {
    constructor() {
        this.globalBasicData = '';
        this.globalAdvancedData = '';
        this.courseCategories = {
            '기본': [...],
            '심화': [...],
            '법정': [...],
            '특별': [...]
        };
    }
    
    saveBasicData()           // 기본교육 데이터 저장
    saveAdvancedData()        // 심화교육 데이터 저장
    parseEducationData()      // 교육 데이터 파싱
    calculateAdvancedFillRate() // 충원률 계산
    processDataInBatches()    // 배치 데이터 처리
}
```

#### 핵심 알고리즘

##### 교육 과정 자동 분류
```javascript
getCourseCategory(courseName) {
    const lowerCourseName = courseName.toLowerCase();
    
    for (const [category, keywords] of Object.entries(this.courseCategories)) {
        if (keywords.some(keyword => 
            lowerCourseName.includes(keyword.toLowerCase()))) {
            return category;
        }
    }
    return '기타';
}
```

##### 충원률 계산
```javascript
calculateAdvancedFillRate(stats, institutionInfo, jobType, refDate) {
    const totalEmployees = institutionInfo[jobType] || 0;
    if (totalEmployees === 0) return 0;
    
    const completedEmployees = stats.완료인원 || 0;
    return Math.round((completedEmployees / totalEmployees) * 100);
}
```

##### 배치 데이터 처리
```javascript
processDataInBatches(masterRows, resultTableHead, resultTableBody, 
                     basicCompletionMap, advancedCompletionMap, originalHeaderRow) {
    const BATCH_SIZE = 50;
    let currentIndex = 0;
    
    const processBatch = () => {
        const endIndex = Math.min(currentIndex + BATCH_SIZE, masterRows.length);
        
        // 배치 단위로 데이터 처리
        for (let i = currentIndex; i < endIndex; i++) {
            // 개별 행 처리 로직
        }
        
        // 다음 배치 예약
        if (currentIndex < masterRows.length) {
            setTimeout(processBatch, 0);
        }
    };
    
    processBatch();
}
```

### 🎨 UI Service 모듈 (`ui-service.js`)

#### 클래스 구조
```javascript
class UiService {
    constructor() {
        this.currentMainTab = 'education-management-tab';
        this.currentSubTabs = {
            'education-management-tab': 'basic-tab',
            'employee-management-tab': 'employee-status',
            'integration-analysis-tab': 'employee-education'
        };
    }
    
    initialize()           // UI 서비스 초기화
    openTab()             // 메인 탭 전환
    openSubTab()          // 서브 탭 전환
    setupEventHandlers()  // 이벤트 핸들러 설정
    createTable()         // 동적 테이블 생성
}
```

#### 탭 관리 시스템

##### 메인 탭 전환
```javascript
openTab(evt, tabName) {
    // 모든 메인 탭 비활성화
    const mainTabs = document.querySelectorAll(
        '#education-management-tab, #employee-management-tab, #integration-analysis-tab'
    );
    mainTabs.forEach(tab => tab.classList.remove('active'));
    
    // 대상 탭 활성화
    const target = document.getElementById(tabName);
    if (target) {
        target.classList.add('active');
        this.currentMainTab = tabName;
    }
    
    // 서브탭 기본값 설정
    this.resetSubTabToDefault(tabName);
}
```

##### 동적 테이블 생성
```javascript
createTable(headers, data, containerId) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    container.innerHTML = '';
    
    // 테이블 래퍼 생성
    const tableWrapper = document.createElement('div');
    tableWrapper.className = 'table-wrapper';
    
    // 스크롤 컨테이너 생성
    const tableContainer = document.createElement('div');
    tableContainer.className = 'table-container';
    
    // 테이블 생성
    const table = document.createElement('table');
    
    // 헤더 생성
    const thead = document.createElement('thead');
    const headerRow = document.createElement('tr');
    headers.forEach(header => {
        const th = document.createElement('th');
        th.textContent = header;
        headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    
    // 바디 생성
    const tbody = document.createElement('tbody');
    data.forEach(rowData => {
        const row = document.createElement('tr');
        rowData.forEach(cellData => {
            const td = document.createElement('td');
            td.textContent = cellData;
            row.appendChild(td);
        });
        tbody.appendChild(row);
    });
    
    // 테이블 조립
    table.appendChild(thead);
    table.appendChild(tbody);
    tableContainer.appendChild(table);
    tableWrapper.appendChild(tableContainer);
    container.appendChild(tableWrapper);
}
```

### 📁 File Operations Service 모듈 (`file-operations-service.js`)

#### 클래스 구조
```javascript
class FileOperationsService {
    constructor() {
        this.supportedFormats = ['xlsx', 'xls', 'csv', 'txt', 'tsv'];
    }
    
    loadBasicEducationFile()    // 기본교육 파일 로드
    loadAdvancedEducationFile() // 심화교육 파일 로드
    validateFileFormat()        // 파일 형식 검증
    exportDataToFormat()        // 데이터 내보내기
    processFileData()           // 파일 데이터 처리
}
```

#### 파일 처리 로직

##### 파일 형식 검증
```javascript
validateFileFormat(filename) {
    if (!filename) return false;
    
    const extension = filename.split('.').pop()?.toLowerCase();
    return this.supportedFormats.includes(extension);
}
```

##### 다중 형식 내보내기
```javascript
exportDataToFormat(data, filename, format = 'xlsx') {
    try {
        if (format === 'xlsx' || format === 'xls') {
            this.exportToExcel(data, filename);
        } else if (format === 'csv') {
            this.exportToCSV(data, filename);
        } else if (format === 'txt' || format === 'tsv') {
            this.exportToText(data, filename, '\t');
        } else {
            throw new Error(`지원하지 않는 파일 형식: ${format}`);
        }
    } catch (error) {
        console.error('파일 내보내기 오류:', error);
        alert(`파일 내보내기 중 오류가 발생했습니다: ${error.message}`);
    }
}
```

### 📊 Excel Export Service 모듈 (`excel-export-service.js`)

#### 클래스 구조
```javascript
class ExcelExportService {
    constructor() {
        this.workbook = null;
        this.isSheetJSLoaded = false;
    }
    
    loadSheetJS()           // SheetJS 라이브러리 동적 로딩
    exportToExcel()         // Excel 내보내기
    exportMultipleSheets()  // 다중 시트 내보내기
    exportTableToExcel()    // 테이블 → Excel 변환
    generateFileName()      // 파일명 자동 생성
}
```

#### Excel 처리 로직

##### 동적 라이브러리 로딩
```javascript
async loadSheetJS() {
    if (typeof XLSX !== 'undefined') {
        this.isSheetJSLoaded = true;
        return;
    }

    try {
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';
        script.onload = () => {
            this.isSheetJSLoaded = true;
            console.log('SheetJS 라이브러리 로드 완료');
        };
        document.head.appendChild(script);
    } catch (error) {
        console.error('SheetJS 라이브러리 로드 중 오류:', error);
    }
}
```

##### 다중 시트 처리
```javascript
exportMultipleSheets(dataSheets, filePath) {
    this.workbook = XLSX.utils.book_new();
    
    dataSheets.forEach((sheetData, index) => {
        const sheetName = sheetData.name || `시트${index + 1}`;
        let ws;
        
        // 데이터 타입별 처리
        if (this.isTableElement(sheetData.data)) {
            ws = XLSX.utils.table_to_sheet(sheetData.data);
        } else if (Array.isArray(sheetData.data)) {
            ws = XLSX.utils.aoa_to_sheet(sheetData.data);
        } else if (typeof sheetData.data === 'string') {
            const lines = sheetData.data.trim().split('\n');
            const arrayData = lines.map(line => line.split('\t'));
            ws = XLSX.utils.aoa_to_sheet(arrayData);
        }
        
        if (ws) {
            XLSX.utils.book_append_sheet(this.workbook, ws, sheetName);
        }
    });
    
    const filename = filePath || this.generateFileName('다중_시트_데이터');
    XLSX.writeFile(this.workbook, filename);
}
```

### 📚 교육관리 모듈 (UI 컴포넌트)

#### 1. **기본 과정 분석**
- **목적**: 신규자 및 경력자 대상 기본교육 수료 현황 분석
- **입력 데이터**: 기본교육 수료자 명단 (Excel/CSV/텍스트)
- **처리 기능**:
  - 교육과정명 자동 분류 및 정규화
  - 수료 상태 검증 (수료/미수료/진행중)
  - 지역별, 기관별 수료 통계 산출
- **출력 정보**:
  - 전체 수료자 수 및 수료율
  - 기관별 수료 현황 테이블
  - 교육과정별 수료 분포

#### 2. **심화 과정 분석**
- **목적**: 전문성 향상을 위한 심화교육 수료 현황 분석
- **입력 데이터**: 심화교육 수료자 명단
- **처리 기능**:
  - 전담사회복지사/생활지원사 구분 분류
  - 신규자/경력자 심화교육 구분
  - 특화서비스 관련 교육 별도 분류
- **출력 정보**:
  - 직무별 심화교육 수료 현황
  - 경력구분별 교육 참여 통계
  - 전문성 향상 지표

#### 3. **전체 통합 분석**
- **목적**: 모든 교육과정 통합 현황 및 개별 이수 현황
- **입력 데이터**: 전체 교육 참여자 마스터 리스트
- **처리 기능**:
  - 개인별 교육 이수 현황 매칭
  - 기본+심화 통합 수료율 계산
  - 미수료자 식별 및 관리
- **출력 정보**:
  - 개인별 상세 교육 이수 현황
  - 기관별 통합 교육 완성도
  - 교육 목표 달성도 평가

### 👥 종사자관리 모듈

#### 1. **종사자 현황 분석**
- **목적**: 전체 종사자의 재직 상태 및 인사 정보 관리
- **입력 데이터**: 종사자 인사 정보 (A열~N열, 퇴사일 포함)
- **처리 기능**:
  - 기준일 기반 재직/퇴직 상태 자동 판정
  - 근속기간 자동 계산 (일수 단위)
  - 직무구분별 통계 산출
  - 입사일/퇴사일 데이터 검증
- **출력 정보**:
  - 기관별 종사자 현황 상세 테이블
  - 재직/퇴직 통계
  - 평균 근속기간 (전체/전담사회복지사/생활지원사)
  - 인사 데이터 검수 결과

#### 2. **기관 현황 관리**
- **목적**: 기관별 배정 인원 및 운영 현황 관리
- **입력 데이터**: 기관현황 데이터 (복지부 배정, 예산 배정, 실제 채용 등)
- **처리 기능**:
  - 복지부 배정 인원 vs 예산 배정 인원 비교
  - 예산 배정 인원 vs 실제 채용 인원 비교
  - 충원률 자동 계산
  - 기관별 운영 효율성 분석
- **출력 정보**:
  - 기관별 배정 및 채용 현황 테이블
  - 충원률 및 운영 지표
  - 미충원 기관 식별

### 🔗 연동분석 모듈

#### 1. **교육 연동**
- **목적**: 종사자 정보와 교육 수료 데이터 자동 매칭
- **처리 방식**: ID 기반 정확한 데이터 매칭
- **매칭 알고리즘**:
  - 1차: 정확한 ID 매칭
  - 2차: 이름 + 기관정보 매칭
  - 3차: 유사도 기반 매칭
- **출력 정보**:
  - 개인별 교육 이수 상태 (기본/심화)
  - 매칭 성공률 및 미매칭 데이터 목록
  - 데이터 품질 평가

#### 2. **통합 대시보드**
- **목적**: 종합적인 현황 분석 및 최종 통계 제공
- **주요 지표**:
  - 전체 종사자 수 (전담사회복지사 + 생활지원사만)
  - 재직자/퇴직자 구분 통계
  - 최종 교육 수료자 (기본+심화 모두 수료)
  - 기본교육/심화교육 개별 수료자
- **시각화 기능**:
  - 실시간 통계 수치 업데이트
  - 색상 기반 성과 지표 (녹색/주황/빨강)
  - 기관별 상세 현황 테이블

#### 3. **종사자 현황 종합 통계표**
- **목적**: 최고 수준의 상세 통계 보고서 생성
- **구성 요소**:
  - **A구간**: 배정인원 (복지부 배정 기준)
  - **B구간**: 예산배정인원 (예산내시 등록 기준)  
  - **C구간**: D채용인원 (기관현황 실제 채용 기준)
  - **D구간**: 종사자 채용현황 (재직자 기준)
  - **E구간**: 종사자 근속현황 (평균 근속기간)
  - **F구간**: 종사자 직무교육 이수율 (대상인원/이수인원/이수율)

---

## 📊 데이터 구조 및 처리 방식

### 데이터 입력 형식

#### 교육 데이터 구조
```
기본교육: No, 소속, 기관코드, 유형, 회원명, 성별, 생년월일, ID, 수행기관명, 이메일, 수강건수, 접속일, 가입일, 직군, 입사일, 퇴사일, 특화, 중간관리자, 최고관리자, 경력, 시범사업참여여부, 이메일수신동의여부, SMS수신동의여부, 상태

심화교육: 동일한 구조로 교육과정명이 다름

전체통합: 마스터 리스트 형태로 모든 교육 참여 대상자 포함
```

#### 종사자 데이터 구조
```
종사자현황: 광역시, 지자체, 광역코드, 광역명, 수행기관코드, 직무구분, 담당업무, 성명, 경력구분/엔젤코드, 생년월일, 성별, 입사일, 퇴사일, 비고

기관현황: 광역시, 지자체, 광역코드, 광역명, 수행기관코드, 수행기관위수탁구분, 위수탁기간, 사업수행도이력, 시설유형구분, 특화, 유관서비스, 기관정보, 기본연락망, 복지부 배정 인원(전담사회복지사/생활지원사), 예산배정 인원(전담사회복지사/생활지원사), 채용 인원(전담사회복지사/생활지원사)
```

### 데이터 처리 알고리즘

#### 1. **자동 헤더 인식**
```javascript
// 헤더 키워드 기반 자동 인식
const headerKeywords = ['광역시','지자체','광역코드','광역명','수행기관코드','직무구분','담당업무','성명','경력','생년월일','성별','입사일','퇴사일'];

// 최대 10행 내에서 헤더 위치 자동 탐지
const findHeaderRow = (rows) => {
    for(let i = 0; i < Math.min(10, rows.length); i++) {
        const hitCount = headerKeywords.reduce((acc, keyword) => 
            acc + (rows[i].includes(keyword) ? 1 : 0), 0);
        if(hitCount >= 3) return i;
    }
    return 0;
};
```

#### 2. **날짜 처리 및 검증**
```javascript
// 다양한 날짜 형식 지원
const parseDate = (dateStr) => {
    const formats = [
        /^\d{4}-\d{2}-\d{2}$/,     // 2024-01-01
        /^\d{4}\/\d{2}\/\d{2}$/,   // 2024/01/01
        /^\d{4}\.\d{2}\.\d{2}$/,   // 2024.01.01
        /^\d{2}-\d{2}-\d{4}$/      // 01-01-2024
    ];
    
    for(const format of formats) {
        if(format.test(dateStr)) {
            return new Date(dateStr);
        }
    }
    return null;
};
```

#### 3. **근속기간 계산**
```javascript
const calculateDuration = (hireDate, referenceDate, resignDate = null) => {
    if(!hireDate || hireDate > referenceDate) return 0;
    
    const endDate = (resignDate && resignDate < referenceDate) 
        ? resignDate : referenceDate;
    
    const diffTime = Math.abs(endDate - hireDate);
    return Math.ceil(diffTime / (1000 * 60 * 60 * 24)); // 일수 변환
};
```

#### 4. **기관명 매칭 알고리즘**
```javascript
const matchInstitution = (institutionCode, institutionName) => {
    // 1순위: 기관현황 테이블에서 코드 매칭
    const exactMatch = findByCode(institutionCode);
    if(exactMatch) return exactMatch;
    
    // 2순위: 이름 유사도 매칭
    const similarityMatch = findBySimilarity(institutionName, threshold: 0.8);
    if(similarityMatch) return similarityMatch;
    
    // 3순위: 기본 형식 반환
    return `${institutionCode}_${institutionName}`;
};
```

### 통계 계산 로직

#### 채용률 계산
```javascript
const calculateHiringRate = (actualHired, budgetAllocated) => {
    if(budgetAllocated === 0) return '0%';
    return ((actualHired / budgetAllocated) * 100).toFixed(1) + '%';
};
```

#### 충원률 계산  
```javascript
const calculateFillRate = (actualHired, plannedHired) => {
    if(plannedHired === 0) return '0%';
    return ((actualHired / plannedHired) * 100).toFixed(1) + '%';
};
```

#### 교육 이수율 계산
```javascript
const calculateCompletionRate = (completed, total) => {
    if(total === 0) return '0%';
    return ((completed / total) * 100).toFixed(1) + '%';
};
```

---

## 🔧 기술적 구현

### 모듈화된 아키텍처 구조

#### Frontend (Modular)
- **HTML5**: 시맨틱 마크업 및 반응형 레이아웃
- **CSS3**: Grid/Flexbox 기반 모던 UI, CSS Variables 활용
- **Vanilla JavaScript**: ES6+ 클래스 기반 모듈 구조
- **Local Storage**: 클라이언트 사이드 데이터 지속성
- **모듈 시스템**: 5개 독립 서비스 클래스로 분리

#### Backend
- **Electron Main Process**: 파일 시스템 접근, IPC 통신
- **Node.js**: 파일 처리 및 Excel 파싱
- **IPC (Inter-Process Communication)**: 렌더러-메인 프로세스 통신

### 모듈 로딩 시스템

```html
<!-- index-modular.html -->
<script src="ipc-service.js"></script>
<script src="data-processing-service.js"></script>
<script src="ui-service.js"></script>
<script src="file-operations-service.js"></script>
<script src="excel-export-service.js"></script>

<script>
// 초기화 시퀀스
(function initializeApp() {
    console.log('=== 교육관리시스템 초기화 시작 ===');
    
    // 서비스 초기화
    if (window.ipcService) {
        window.ipcService.initialize();
        window.ipcService.setupListeners();
    }
    
    if (window.uiService) {
        window.uiService.initialize();
    }
    
    console.log('=== 모든 서비스 초기화 완료 ===');
})();
</script>
```

### 전역 서비스 접근

```javascript
// 전역 window 객체에 서비스 등록
window.ipcService = new IpcService();
window.dataProcessingService = new DataProcessingService();
window.uiService = new UiService();
window.fileOperationsService = new FileOperationsService();
window.excelExportService = new ExcelExportService();

// 어디서든 접근 가능
function handleButtonClick() {
    window.dataProcessingService.processData(data);
    window.uiService.showLoadingMessage('loading-container');
}
```

### 주요 기술 스택

#### 핵심 라이브러리
```json
{
  "electron": "^22.0.0",
  "xlsx": "^0.18.5",
  "exceljs": "^4.3.0"
}
```

#### 파일 처리
- **Excel 읽기**: SheetJS (xlsx) 라이브러리 활용
- **Excel 쓰기**: ExcelJS 라이브러리로 다중 시트 생성
- **CSV 처리**: 내장 텍스트 파싱 알고리즘

### 메모리 최적화

#### 대용량 데이터 처리
```javascript
// 청크 단위 데이터 처리로 메모리 효율성 확보
const processLargeDataset = (data, chunkSize = 1000) => {
    const chunks = [];
    for(let i = 0; i < data.length; i += chunkSize) {
        chunks.push(data.slice(i, i + chunkSize));
    }
    
    return chunks.map(chunk => processChunk(chunk));
};
```

#### 메모리 해제
```javascript
// 대용량 테이블 렌더링 시 가상화 적용
const virtualizeTable = (data, visibleRows = 50) => {
    const viewport = document.getElementById('table-viewport');
    const startIndex = Math.floor(viewport.scrollTop / rowHeight);
    const endIndex = Math.min(startIndex + visibleRows, data.length);
    
    renderRows(data.slice(startIndex, endIndex));
};
```

### 성능 최적화

#### 1. **지연 로딩 (Lazy Loading)**
```javascript
// 테이블 데이터 지연 로딩
const lazyLoadTableData = () => {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if(entry.isIntersecting) {
                loadNextBatch();
            }
        });
    });
    
    observer.observe(document.getElementById('load-trigger'));
};
```

#### 2. **디바운싱 (Debouncing)**
```javascript
// 검색 입력 디바운싱으로 성능 향상
const debounce = (func, wait) => {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
};
```

#### 3. **캐싱 전략**
```javascript
// 계산 결과 캐싱으로 중복 연산 방지
const memoize = (fn) => {
    const cache = new Map();
    return (...args) => {
        const key = JSON.stringify(args);
        if(cache.has(key)) {
            return cache.get(key);
        }
        const result = fn(...args);
        cache.set(key, result);
        return result;
    };
};
```

---

## 📖 사용자 가이드

### 시작하기

#### 1. **시스템 실행**
```bash
# 개발 모드 실행
npm run dev

# 프로덕션 빌드 실행  
npm run build
npm start
```

#### 2. **첫 데이터 입력**
1. **📚 교육관리** 탭 선택
2. **기본 과정** 서브탭에서 "📂 파일에서 불러오기" 클릭
3. Excel 파일 선택 또는 데이터 복사/붙여넣기
4. **[ 기본 과정 분석 ]** 버튼 클릭

### 단계별 워크플로우

#### Phase 1: 교육 데이터 분석
```
1. 기본 과정 → 데이터 입력 → 분석 실행
2. 심화 과정 → 데이터 입력 → 분석 실행  
3. 전체 통합 → 마스터 리스트 입력 → 분석 실행
```

#### Phase 2: 종사자 데이터 관리
```
1. 종사자 현황 → 인사 데이터 입력 → 기준일 설정 → 분석 실행
2. 기관 현황 → 기관 정보 입력 → 배정/채용 현황 분석
```

#### Phase 3: 데이터 연동 및 최종 분석
```
1. 교육 연동 → ID 매칭 실행 → 매칭 결과 확인
2. 통합 대시보드 → 최종 종합 분석 생성 → 결과 검토
3. Excel 내보내기 → 보고서 생성 완료
```

### 단축키 가이드

#### 파일 작업
- **Ctrl+O**: 기본교육 데이터 파일 열기
- **Ctrl+Shift+O**: 심화교육 데이터 파일 열기
- **Ctrl+Alt+O**: 전체인원 데이터 파일 열기
- **Ctrl+Shift+E**: 종사자현황 데이터 파일 열기
- **Ctrl+Shift+I**: 기관현황 데이터 파일 열기
- **Ctrl+S**: 결과를 Excel 파일로 내보내기

#### 탭 네비게이션
- **Tab**: 다음 입력 필드로 이동
- **Shift+Tab**: 이전 입력 필드로 이동
- **Enter**: 현재 탭에서 분석 실행

### 데이터 입력 가이드

#### Excel 파일 형식 요구사항
```
1. 첫 번째 시트 데이터 사용
2. 헤더는 1~10행 내에 위치
3. 날짜 형식: YYYY-MM-DD, YYYY/MM/DD, YYYY.MM.DD 지원
4. 인코딩: UTF-8 권장
5. 최대 행 수: 100,000행 (메모리 제한에 따라)
```

#### 텍스트 복사/붙여넣기 요구사항
```
1. 탭(\t) 구분자 사용
2. 행 구분자: 줄바꿈(\n)
3. 첫 줄을 헤더로 인식
4. 특수문자 이스케이프 처리
```

---

## 🔍 문제해결 가이드

### 일반적인 문제

#### 1. **파일 로드 실패**
**증상**: "파일을 읽을 수 없습니다" 오류
**원인**: 
- 잘못된 파일 형식
- 파일 권한 문제
- 메모리 부족

**해결방법**:
```bash
1. 파일 형식 확인 (.xlsx, .xls, .csv)
2. 파일 권한 확인 (읽기 권한 필요)
3. 파일 크기 확인 (100MB 이하 권장)
4. 애플리케이션 재시작
```

#### 2. **데이터 매칭 실패**  
**증상**: ID 매칭률이 낮음 (50% 이하)
**원인**:
- ID 형식 불일치
- 공백 문자 포함
- 대소문자 차이

**해결방법**:
```javascript
// ID 정규화 처리
const normalizeId = (id) => {
    return id.toString().trim().toLowerCase().replace(/\s+/g, '');
};
```

#### 3. **통계 계산 오류**
**증상**: 채용률, 충원률이 비정상적으로 높거나 낮음
**원인**:
- 기준일 설정 오류
- 퇴사일 데이터 누락
- 직무구분 오분류

**해결방법**:
```
1. 기준일을 현재 날짜로 설정
2. 퇴사일이 공란인 경우 재직자로 처리되는지 확인
3. 직무구분 키워드 확인 ("전담사회복지사", "생활지원사")
```

### 성능 관련 문제

#### 1. **대용량 데이터 처리 지연**
**증상**: 10,000행 이상 데이터에서 분석이 느림
**해결방법**:
```javascript
// 배치 처리로 성능 향상
const BATCH_SIZE = 1000;
const processBatch = async (data, startIndex) => {
    const batch = data.slice(startIndex, startIndex + BATCH_SIZE);
    await processDataBatch(batch);
    
    if(startIndex + BATCH_SIZE < data.length) {
        setTimeout(() => processBatch(data, startIndex + BATCH_SIZE), 10);
    }
};
```

#### 2. **메모리 사용량 증가**
**증상**: 애플리케이션 사용 중 메모리가 계속 증가
**해결방법**:
```javascript
// 메모리 정리
const cleanupMemory = () => {
    // 대용량 배열 참조 해제
    largeDataArrays.forEach(arr => arr.length = 0);
    
    // DOM 이벤트 리스너 제거
    document.removeEventListener('scroll', onScrollHandler);
    
    // 강제 가비지 컬렉션 (개발 모드만)
    if(process.env.NODE_ENV === 'development') {
        global.gc();
    }
};
```

### 데이터 품질 문제

#### 1. **날짜 인식 실패**
**증상**: 입사일, 퇴사일이 "Invalid Date"로 표시
**해결방법**:
```javascript
// 다양한 날짜 형식 지원
const parseDateFlexible = (dateStr) => {
    const patterns = [
        /^(\d{4})-(\d{2})-(\d{2})$/,
        /^(\d{4})\/(\d{2})\/(\d{2})$/,
        /^(\d{2})\/(\d{2})\/(\d{4})$/,
        /^(\d{4})\.(\d{2})\.(\d{2})$/
    ];
    
    for(const pattern of patterns) {
        const match = dateStr.match(pattern);
        if(match) {
            return new Date(match[1], match[2] - 1, match[3]);
        }
    }
    return null;
};
```

#### 2. **한글 인코딩 문제**
**증상**: 한글이 깨져서 표시됨
**해결방법**:
```javascript
// UTF-8 인코딩 강제 적용
const readFileWithEncoding = (filePath) => {
    const fs = require('fs');
    const iconv = require('iconv-lite');
    
    const buffer = fs.readFileSync(filePath);
    return iconv.decode(buffer, 'utf-8');
};
```

---

## 🚀 시스템 확장성

### 향후 개발 계획

#### Phase 1: UI/UX 개선 (v1.3.0)
- **반응형 디자인**: 태블릿, 모바일 지원
- **다크 모드**: 사용자 선택 가능한 테마
- **접근성 향상**: 스크린 리더, 키보드 네비게이션
- **다국어 지원**: 영어, 중국어 UI 제공

#### Phase 2: 데이터 분석 고도화 (v1.4.0)
- **머신러닝**: 교육 수료 예측 모델
- **시계열 분석**: 채용 트렌드, 교육 효과 분석
- **예측 통계**: 향후 인력 수요 예측
- **벤치마킹**: 유사 기관 대비 성과 비교

#### Phase 3: 클라우드 연동 (v1.5.0)
- **클라우드 저장소**: AWS S3, Google Drive 연동
- **실시간 동기화**: 다중 사용자 협업 기능
- **웹 대시보드**: 브라우저 기반 실시간 모니터링
- **API 제공**: 외부 시스템 연동 인터페이스

#### Phase 4: 고급 기능 (v2.0.0)
- **워크플로우 자동화**: 정기 보고서 자동 생성
- **알림 시스템**: 교육 마감일, 인사발령 알림
- **감사 추적**: 데이터 변경 이력 관리
- **권한 관리**: 사용자별 접근 권한 설정

### 확장 가능한 아키텍처

#### 모듈화된 구조
```javascript
// 플러그인 시스템 도입
const PluginManager = {
    plugins: new Map(),
    
    register(name, plugin) {
        this.plugins.set(name, plugin);
    },
    
    execute(name, data) {
        const plugin = this.plugins.get(name);
        return plugin ? plugin.process(data) : null;
    }
};

// 커스텀 분석 모듈 추가 예시
PluginManager.register('customAnalysis', {
    name: '사용자 정의 분석',
    version: '1.0.0',
    process: (data) => {
        // 사용자 정의 분석 로직
        return processCustomAnalysis(data);
    }
});
```

#### 설정 가능한 통계 지표
```javascript
// 동적 통계 지표 정의
const StatisticsConfig = {
    indicators: [
        {
            name: '채용률',
            formula: '(채용인원 / 배정인원) * 100',
            threshold: { good: 90, warning: 70 },
            color: { good: '#27ae60', warning: '#f39c12', bad: '#e74c3c' }
        },
        {
            name: '교육이수율', 
            formula: '(이수인원 / 대상인원) * 100',
            threshold: { good: 95, warning: 80 },
            color: { good: '#27ae60', warning: '#f39c12', bad: '#e74c3c' }
        }
    ]
};
```

### API 설계 (향후 버전)

#### RESTful API 엔드포인트
```javascript
// 교육 데이터 API
GET    /api/v1/education/basic           // 기본교육 데이터 조회
POST   /api/v1/education/basic           // 기본교육 데이터 등록
PUT    /api/v1/education/basic/:id       // 기본교육 데이터 수정
DELETE /api/v1/education/basic/:id       // 기본교육 데이터 삭제

// 종사자 데이터 API
GET    /api/v1/employees                 // 종사자 목록 조회
GET    /api/v1/employees/:id             // 특정 종사자 조회
POST   /api/v1/employees                 // 종사자 등록
PUT    /api/v1/employees/:id             // 종사자 정보 수정

// 통계 API
GET    /api/v1/statistics/hiring-rate    // 채용률 통계
GET    /api/v1/statistics/completion     // 교육 이수율 통계  
GET    /api/v1/statistics/dashboard      // 대시보드 데이터
```

#### GraphQL 스키마 (대안)
```graphql
type Employee {
    id: ID!
    name: String!
    position: String!
    hireDate: DateTime!
    resignDate: DateTime
    institution: Institution!
    educations: [Education!]!
}

type Education {
    id: ID!
    course: String!
    completionDate: DateTime
    status: EducationStatus!
}

type Query {
    employees(filter: EmployeeFilter): [Employee!]!
    statistics(period: DateRange!): Statistics!
    dashboard: DashboardData!
}

type Mutation {
    createEmployee(input: CreateEmployeeInput!): Employee!
    updateEmployee(id: ID!, input: UpdateEmployeeInput!): Employee!
    deleteEmployee(id: ID!): Boolean!
}
```

---

## 📞 지원 및 연락처

### 기술 지원
- **개발팀 이메일**: dev-support@education-system.com
- **이슈 트래커**: https://github.com/education-system/issues
- **문서 위키**: https://github.com/education-system/wiki

### 사용자 가이드
- **사용자 매뉴얼**: `/docs/user-manual.pdf`
- **비디오 튜토리얼**: https://youtube.com/education-system-tutorials
- **FAQ**: https://education-system.com/faq

### 커뮤니티
- **사용자 포럼**: https://community.education-system.com
- **Slack 워크스페이스**: education-system.slack.com
- **월간 웨비나**: 매월 셋째 주 화요일 14:00

---

## 📄 라이선스

```
MIT License

Copyright (c) 2025 Education Management System

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

## 📋 버전 히스토리

### v2.0.0-modular (현재) - 2025.08.11
- ✅ 전체 시스템 모듈화 리팩터링
- ✅ 5개 독립 서비스 모듈로 분리
  - IPC Service: Electron 통신 관리
  - Data Processing Service: 데이터 가공 및 분석
  - UI Service: 탭 및 DOM 관리
  - File Operations Service: 파일 처리
  - Excel Export Service: Excel 내보내기
- ✅ 클래스 기반 객체지향 설계 적용
- ✅ 모듈 간 느슨한 결합도 구현
- ✅ 유지보수성 및 확장성 대폭 개선
- ✅ 기존 기능 100% 호환성 유지
- ✅ index-modular.html 새 버전 생성
- ✅ 기존 파일 백업 보존

### v1.2.0 - 2025.01.27
- ✅ 종사자 현황 종합 통계표 완성
- ✅ 실시간 충원률 계산 로직 구현
- ✅ 통합 대시보드 UI/UX 개선
- ✅ Excel 다중 시트 내보내기 기능
- ✅ 데이터 초기화 버튼 활성화

### v1.1.0 - 2025.01.20
- ✅ 교육-종사자 데이터 연동 기능
- ✅ ID 기반 자동 매칭 알고리즘
- ✅ 기관별 종합 통계 생성
- ✅ 색상 기반 성과 지표 시각화

### v1.0.0 - 2025.01.15
- ✅ 기본 시스템 아키텍처 구축
- ✅ 3단계 워크플로우 구현
- ✅ 교육관리 모듈 (기본/심화/통합)
- ✅ 종사자관리 모듈 (현황/기관)
- ✅ Excel 파일 읽기/쓰기 기능

### 모듈화 이전/이후 비교

| 구분 | 이전 버전 (v1.2.0) | 모듈화 버전 (v2.0.0) |
|------|-------------------|----------------------|
| 파일 구조 | 단일 거대 HTML 파일 (3,600+ 라인) | 6개 분리된 모듈 파일 |
| 코드 구조 | 절차적 함수형 프로그래밍 | 객체지향 클래스 기반 |
| 유지보수성 | 낮음 (전체 파일 수정 필요) | 높음 (모듈별 독립 수정) |
| 재사용성 | 낮음 (코드 중복 존재) | 높음 (모듈 독립 재활용) |
| 확장성 | 제한적 | 우수 (새 모듈 추가 용이) |
| 테스트 가능성 | 어려움 | 용이 (모듈별 단위 테스트) |
| 개발 효율성 | 낮음 (코드 충돌 발생) | 높음 (병렬 개발 가능) |

---

**문서 작성일**: 2025년 1월 27일  
**문서 버전**: v2.0  
**최종 수정**: 2025년 8월 11일 (모듈화 반영)  
**작성자**: AI Assistant  

---

*이 문서는 교육관리 시스템 v2.0.0-modular 기준으로 작성되었습니다. 모듈화된 새 아키텍처에 대한 최신 정보를 포함하고 있으니, 기존 v1.x 버전과의 차이점을 확인하시기 바랍니다.*